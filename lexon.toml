# ðŸ”§ Lexon Configuration File
# =============================
# Complete configuration for Lexon projects (Sprint B)

# Sprint B: Project and modules configuration
[project]
name = "lexon-project"
version = "1.0.0"
description = "A Lexon DSL project"
modules_dir = "modules"
output_dir = "target"
include = ["*.lx", "modules/**/*.lx", "data/**/*"]
exclude = ["target/**/*", "*.tmp", "*.log"]

# LLM system configuration
[system]
default_provider = "openai"
[vector]
# backend: sqlite_local | qdrant
backend = "sqlite_local"
# qdrant settings (used when backend = "qdrant")
qdrant_url = "http://127.0.0.1:6333"
qdrant_collection = "lexon_docs"
# qdrant_api_key is read from env LEXON_QDRANT_API_KEY if needed

fallback_provider = "simulated"
fallback_model = "simulated"
cache_enabled = true
retry_attempts = 3
timeout_default = 30

# Sprint B: Memory configuration
[memory]
storage_path = ".lexon/memory"
max_entries = 10000
cleanup_interval = "24h"

# Sprint B: Validation configuration
[validation]
default_strategy = "basic"
confidence_threshold = 0.8
max_attempts = 3

# Sprint B: Logging configuration
[logging]
level = "info"
output = "stdout"
file_path = ".lexon/logs/lexon.log"

# LLM providers configuration
[providers.openai]
name = "OpenAI"
base_url = "https://api.openai.com/v1"
auth_header = "Authorization"
auth_format = "Bearer {api_key}"
api_key_env = "OPENAI_API_KEY"
default_model = "gpt-4"
timeout = 60

[providers.openai.endpoints]
chat = "chat/completions"
completions = "completions"

[providers.openai.models]
"gpt-4" = { max_tokens = 8192, cost_per_1k = 0.03 }
"gpt-4-turbo" = { max_tokens = 128000, cost_per_1k = 0.01 }
"gpt-3.5-turbo" = { max_tokens = 4096, cost_per_1k = 0.002 }
"gpt-4o" = { max_tokens = 128000, cost_per_1k = 0.01 }
"gpt-4o-mini" = { max_tokens = 128000, cost_per_1k = 0.003 }

[providers.anthropic]
name = "Anthropic"
base_url = "https://api.anthropic.com/v1"
auth_header = "x-api-key"
auth_format = "{api_key}"
api_key_env = "ANTHROPIC_API_KEY"
default_model = "claude-3-5-sonnet-20241022"
timeout = 60

[providers.anthropic.headers]
"anthropic-version" = "2023-06-01"
"content-type" = "application/json"

[providers.anthropic.endpoints]
messages = "messages"

[providers.anthropic.models]
"claude-3-5-sonnet-20241022" = { max_tokens = 200000, cost_per_1k = 0.003 }
"claude-3-5-sonnet-20240620" = { max_tokens = 200000, cost_per_1k = 0.003 }
"claude-3-opus-20240229" = { max_tokens = 200000, cost_per_1k = 0.015 }
"claude-3-haiku-20240307" = { max_tokens = 200000, cost_per_1k = 0.00025 }

[providers.google]
name = "Google"
base_url = "https://generativelanguage.googleapis.com/v1beta"
auth_format = "key={api_key}"
api_key_env = "GOOGLE_API_KEY"
default_model = "gemini-2.5-pro"
timeout = 45

[providers.google.endpoints]
generate = "models/{model}:generateContent"

[providers.google.models]
"gemini-2.5-pro" = { max_tokens = 1000000, cost_per_1k = 0.0035 }
"gemini-2.5-flash" = { max_tokens = 1000000, cost_per_1k = 0.00035 } 

# [web_search]
# provider = "duckduckgo"
# endpoint = "https://api.duckduckgo.com/"
# query_param = "q"
# count_param = "n"
# format_param = "format"
# format_value = "json"
# # auth: none|header|query
# auth_mode = "none"
# auth_name = "Authorization"
# auth_env = "WEB_SEARCH_API_KEY"
# # extra params if needed
# extra_params = { no_redirect = "1", no_html = "1" }

# Brave Search preset (uncomment to use)
#[web_search]
#provider = "brave"
#endpoint = "https://api.search.brave.com/res/v1/web/search"
#query_param = "q"
#count_param = "count"
#auth_mode = "header"
#auth_name = "X-Subscription-Token"
#auth_env = "BRAVE_SEARCH_API_KEY"

# SerpAPI active config
[web_search]
provider = "serpapi"
endpoint = "https://serpapi.com/search.json"
query_param = "q"
count_param = "num"
auth_mode = "query"       # API key passed as query param
auth_name = "api_key"     # parameter name used by SerpAPI
auth_env = "SERPAPI_API_KEY"
extra_params = { engine = "google" }